<!DOCTYPE HTML>
<html lang="en" class="light sidebar-visible" dir="ltr">
    <head>
        <!-- Book generated using mdBook -->
        <meta charset="UTF-8">
        <title>intel_fw</title>
        <meta name="robots" content="noindex">


        <!-- Custom HTML head -->

        <meta name="description" content="">
        <meta name="viewport" content="width=device-width, initial-scale=1">
        <meta name="theme-color" content="#ffffff">

        <link rel="icon" href="favicon.svg">
        <link rel="shortcut icon" href="favicon.png">
        <link rel="stylesheet" href="css/variables.css">
        <link rel="stylesheet" href="css/general.css">
        <link rel="stylesheet" href="css/chrome.css">
        <link rel="stylesheet" href="css/print.css" media="print">

        <!-- Fonts -->
        <link rel="stylesheet" href="FontAwesome/css/font-awesome.css">
        <link rel="stylesheet" href="fonts/fonts.css">

        <!-- Highlight.js Stylesheets -->
        <link rel="stylesheet" id="highlight-css" href="highlight.css">
        <link rel="stylesheet" id="tomorrow-night-css" href="tomorrow-night.css">
        <link rel="stylesheet" id="ayu-highlight-css" href="ayu-highlight.css">

        <!-- Custom theme stylesheets -->


        <!-- Provide site root and default themes to javascript -->
        <script>
            const path_to_root = "";
            const default_light_theme = "light";
            const default_dark_theme = "navy";
        </script>
        <!-- Start loading toc.js asap -->
        <script src="toc.js"></script>
    </head>
    <body>
    <div id="body-container">
        <!-- Work around some values being stored in localStorage wrapped in quotes -->
        <script>
            try {
                let theme = localStorage.getItem('mdbook-theme');
                let sidebar = localStorage.getItem('mdbook-sidebar');

                if (theme.startsWith('"') && theme.endsWith('"')) {
                    localStorage.setItem('mdbook-theme', theme.slice(1, theme.length - 1));
                }

                if (sidebar.startsWith('"') && sidebar.endsWith('"')) {
                    localStorage.setItem('mdbook-sidebar', sidebar.slice(1, sidebar.length - 1));
                }
            } catch (e) { }
        </script>

        <!-- Set the theme before any content is loaded, prevents flash -->
        <script>
            const default_theme = window.matchMedia("(prefers-color-scheme: dark)").matches ? default_dark_theme : default_light_theme;
            let theme;
            try { theme = localStorage.getItem('mdbook-theme'); } catch(e) { }
            if (theme === null || theme === undefined) { theme = default_theme; }
            const html = document.documentElement;
            html.classList.remove('light')
            html.classList.add(theme);
            html.classList.add("js");
        </script>

        <input type="checkbox" id="sidebar-toggle-anchor" class="hidden">

        <!-- Hide / unhide sidebar before it is displayed -->
        <script>
            let sidebar = null;
            const sidebar_toggle = document.getElementById("sidebar-toggle-anchor");
            if (document.body.clientWidth >= 1080) {
                try { sidebar = localStorage.getItem('mdbook-sidebar'); } catch(e) { }
                sidebar = sidebar || 'visible';
            } else {
                sidebar = 'hidden';
            }
            sidebar_toggle.checked = sidebar === 'visible';
            html.classList.remove('sidebar-visible');
            html.classList.add("sidebar-" + sidebar);
        </script>

        <nav id="sidebar" class="sidebar" aria-label="Table of contents">
            <!-- populated by js -->
            <mdbook-sidebar-scrollbox class="sidebar-scrollbox"></mdbook-sidebar-scrollbox>
            <noscript>
                <iframe class="sidebar-iframe-outer" src="toc.html"></iframe>
            </noscript>
            <div id="sidebar-resize-handle" class="sidebar-resize-handle">
                <div class="sidebar-resize-indicator"></div>
            </div>
        </nav>

        <div id="page-wrapper" class="page-wrapper">

            <div class="page">
                <div id="menu-bar-hover-placeholder"></div>
                <div id="menu-bar" class="menu-bar sticky">
                    <div class="left-buttons">
                        <label id="sidebar-toggle" class="icon-button" for="sidebar-toggle-anchor" title="Toggle Table of Contents" aria-label="Toggle Table of Contents" aria-controls="sidebar">
                            <i class="fa fa-bars"></i>
                        </label>
                        <button id="theme-toggle" class="icon-button" type="button" title="Change theme" aria-label="Change theme" aria-haspopup="true" aria-expanded="false" aria-controls="theme-list">
                            <i class="fa fa-paint-brush"></i>
                        </button>
                        <ul id="theme-list" class="theme-popup" aria-label="Themes" role="menu">
                            <li role="none"><button role="menuitem" class="theme" id="default_theme">Auto</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="light">Light</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="rust">Rust</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="coal">Coal</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="navy">Navy</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="ayu">Ayu</button></li>
                        </ul>
                        <button id="search-toggle" class="icon-button" type="button" title="Search. (Shortkey: s)" aria-label="Toggle Searchbar" aria-expanded="false" aria-keyshortcuts="S" aria-controls="searchbar">
                            <i class="fa fa-search"></i>
                        </button>
                    </div>

                    <h1 class="menu-title">intel_fw</h1>

                    <div class="right-buttons">
                        <a href="print.html" title="Print this book" aria-label="Print this book">
                            <i id="print-button" class="fa fa-print"></i>
                        </a>
                        <a href="https://github.com/platform-system-interface/intel_fw" title="Git repository" aria-label="Git repository">
                            <i id="git-repository-button" class="fa fa-github"></i>
                        </a>

                    </div>
                </div>

                <div id="search-wrapper" class="hidden">
                    <form id="searchbar-outer" class="searchbar-outer">
                        <input type="search" id="searchbar" name="searchbar" placeholder="Search this book ..." aria-controls="searchresults-outer" aria-describedby="searchresults-header">
                    </form>
                    <div id="searchresults-outer" class="searchresults-outer hidden">
                        <div id="searchresults-header" class="searchresults-header"></div>
                        <ul id="searchresults">
                        </ul>
                    </div>
                </div>

                <!-- Apply ARIA attributes after the sidebar and the sidebar toggle button are added to the DOM -->
                <script>
                    document.getElementById('sidebar-toggle').setAttribute('aria-expanded', sidebar === 'visible');
                    document.getElementById('sidebar').setAttribute('aria-hidden', sidebar !== 'visible');
                    Array.from(document.querySelectorAll('#sidebar a')).forEach(function(link) {
                        link.setAttribute('tabIndex', sidebar === 'visible' ? 0 : -1);
                    });
                </script>

                <div id="content" class="content">
                    <main>
                        <h1 id="intel_fw"><a class="header" href="#intel_fw"><code>intel_fw</code></a></h1>
<p>This is both a command-line interface (CLI) and a library for analyzing and
editing firmware images for <a href="./platforms.html">Intel hardware platforms</a>.</p>
<p>The <a href="./architecture.html">architecture</a> is based on <a href="./knowledge.html">knowledge</a>
from prior research.</p>
<div style="break-before: page; page-break-before: always;"></div><h1 id="architecture-and-design"><a class="header" href="#architecture-and-design">Architecture and Design</a></h1>
<p>The following considerations around specifics in the domain of Intel platforms
and firmware are meant to offer a deeper understanding of design choices.</p>
<h2 id="goals"><a class="header" href="#goals">Goals</a></h2>
<h3 id="separate-detection-from-action"><a class="header" href="#separate-detection-from-action">Separate detection from action</a></h3>
<p><code>me_cleaner</code> mixes both, and assessing the exact actions to happen is hard.
Via its CLI, everything a one-shot operation, and the user needs to know the
options beforehand. Note that it is very Unixesque to wrap CLIs in shell scripts
as if they were intended as APIs. That is not meant here.</p>
<p>For programmatic and interactive use, provide an analysis result and let the
programmer/user <em>then</em> choose what they want to do. The programmer has to deal
with all possibilities and may choose strategies around them, whereas the user
can benefit from seeing the options fitting their actual case.</p>
<p>E.g., in a GUI app such as <a href="https://fiedka.app">Fiedka</a> or a TUI that could be
created with <a href="https://ratatui.rs/">ratatui</a>, setting a HAP bit vs legacy
(Alt)MeDisable bit(s) can be elaborated on in a help message or tooltip.
Removable partitions and files can be listed rather than expected to be provided
by the user who, before the analysis, doesn't know what their firmware contains.</p>
<h3 id="comprehensible-and-useful-api"><a class="header" href="#comprehensible-and-useful-api">Comprehensible and useful API</a></h3>
<p>Provide an API that requires little knowledge of internal details.
The job of an API is to simplify, after all. Otherwise, both caller and callee
would duplicate efforts.</p>
<p>Encapsulate rather than exposing many raw structs directly.
Make relationships and containment clear.</p>
<p>E.g., wrap partition entry structs in another struct that carries supporting
metadata with it, such as offset and size, parsing result of what the partition
entry points to, etc..</p>
<p>Follow the <a href="https://rust-lang.github.io/api-guidelines/">Rust API guidelines</a>.</p>
<h2 id="approaches"><a class="header" href="#approaches">Approaches</a></h2>
<p>Replies to a <a href="https://stackoverflow.com/questions/4355263/is-there-a-design-pattern-for-separating-preparation-of-work-from-execution">StackOverflow question on separating preparation from execution</a>
reference the <a href="https://en.wikipedia.org/wiki/Composite_pattern">Composite pattern</a>
and the <a href="https://rust-unofficial.github.io/patterns/patterns/behavioural/command.html">Command pattern</a>.</p>
<p>The Composite pattern helps in that there is a hierarchical structure, i.e.,
IFD, FIT and ME firmware on a high level, and then IFD has its underlying data,
the ME firmware has its FPT and partitions therein, and the FIT points to many
things. Underlying details are very different though, so there are no meaningful
abstractions for common interfaces.</p>
<p>The Command pattern may make sense on a higher level, for example, to collect
the actions resulting from command line switches or API options. At the same
time, it creates more boilerplate code, which may be hard to follow.</p>
<p>Note that we need to check the applicability of operations on two levels:
Some operations exclude others, and some only apply if their assumptions fit
with findings from analyzing the given firmware image.</p>
<p><a href="https://github.com/linuxboot/fiano">Fiano/utk</a> implements the <a href="https://rust-unofficial.github.io/patterns/patterns/behavioural/visitor.html">visitor pattern</a>,
which is meant for objects that are quite similar in some regard.</p>
<p>One issue with firmware images is that while many things are related to each
other, they also have their very specific purposes and semantics, and there is a
rather fixed structure. It would thus be simpler to <strong>deal with specific
operations on a higher level that understands the domain and carries clear
semantics</strong> with it rather than having a visitor/executor encoding each possible
operation for each bit and requiring more understanding from the user and
programmer.
I.e., just have <strong>each entity offer its own unique set of clearly understandable
helpers</strong> and assisting parameters, possibly following a loose pattern when
multiple entities are similar.</p>
<p>For example, some partitions contain directories in the case of generation 2 and
generation 3 ME:
For both generations, certain directories can be partially cleared (whole ranges
of data set to <code>0xff</code>), and both can take a list of things to retain.
That requires helpers which may implement a common trait (interface).
Similarly, other partitions can be cleared, but <em>entirely</em>, so they do not need
extra functionality themselves. Trying to force the same interface on them only
results in unnecessary extra code.</p>
<p>On the other hand, the FPT itself is a small memory slice (found to be &lt;2K), so
it can take care of itself. It has a checksum in its header. Offer helpers for
editing and returning a new slice to replace the original one.
The IFD is similar in that it is also small, but has its own unique features.
And the FIT is yet again very different.</p>
<p>See also the <a href="https://rust-unofficial.github.io/patterns/patterns/behavioural/strategy.html">strategy pattern</a>.</p>
<div style="break-before: page; page-break-before: always;"></div><h1 id="intel-platforms"><a class="header" href="#intel-platforms">Intel platforms</a></h1>
<p>Over the years and decades, Intel has developed many hardware platforms<sup class="footnote-reference" id="fr-14-1"><a href="#footnote-14">1</a></sup>.</p>
<p>Since the 4-bit 4004 in 1971, they have progressed over 8-bit up to 64-bit
systems, retaining a lot of backwards compatibility. Starting with the ICH7
based platforms, Intel introduced their AMT (Active Management Technology)<sup class="footnote-reference" id="fr-15-1"><a href="#footnote-15">2</a></sup>,
an out-of-band management solution<sup class="footnote-reference" id="fr-1-1"><a href="#footnote-1">3</a></sup> for remote provisioning and support.</p>
<p>AMT evolved with more features over time, carrying the vPro label for machines
targeting the business market<sup class="footnote-reference" id="fr-16-1"><a href="#footnote-16">4</a></sup> and finally converging with more security
features such as Boot Guard<sup class="footnote-reference" id="fr-2-1"><a href="#footnote-2">5</a></sup>, Intel's secure boot implementation, digital
content protection (DRM), and more<sup class="footnote-reference" id="fr-20-1"><a href="#footnote-20">6</a></sup>.</p>
<p>Now running on a coprocessor called the (Converged Security and) Manageability
Engine<sup class="footnote-reference" id="fr-3-1"><a href="#footnote-3">7</a></sup>, or (CS)ME for short, henceforth abbreviated as <em>ME</em>, a full second
operating system of its own is backing the platform.</p>
<h2 id="boot-flow"><a class="header" href="#boot-flow">Boot flow</a></h2>
<p>The ME has its own firmware and bootstraps an Intel platform<sup class="footnote-reference" id="fr-19-1"><a href="#footnote-19">8</a></sup>. The main x86
cores are held in reset until the ME releases them to boot with their own
firmware.</p>
<p>Both the ME firmware and the main x86 firmware are stored in the same flash part
on a mainboard, partitioned via the Intel Flash Descriptior (IFD).</p>
<p>The following diagram is based on knowledge from various sources, including the
<a href="https://doc.coreboot.org/soc/intel/fit.html">coreboot documentation on Intel</a>.</p>
<img src="intel_flash_partitioning.png" width=40%>
<p>The boot flow for trusted boot is documented publicly<sup class="footnote-reference" id="fr-17-1"><a href="#footnote-17">9</a></sup> by Intel.</p>
<h2 id="me-classification-and-security"><a class="header" href="#me-classification-and-security">ME classification and security</a></h2>
<p>Security researchers have analyzed the ME<sup class="footnote-reference" id="fr-18-1"><a href="#footnote-18">10</a></sup> and divided hardware variants
into 3 generations<sup class="footnote-reference" id="fr-4-1"><a href="#footnote-4">11</a></sup> thus far, each with their own multiple firmware versions,
including security patch releases[^5]<sup class="footnote-reference" id="fr-6-1"><a href="#footnote-6">12</a></sup>.
One core aspect in security research has been Boot Guard[^7]<sup class="footnote-reference" id="fr-8-1"><a href="#footnote-8">13</a></sup>, which had
been introduced with Haswell, Intel's 4th generation Core series platforms<sup class="footnote-reference" id="fr-10-1"><a href="#footnote-10">14</a></sup>,
and discussed in the coreboot community<sup class="footnote-reference" id="fr-11-1"><a href="#footnote-11">15</a></sup>.</p>
<p>Note that the ME generations roughly correspond with the overall platform, in
that ranges of Intel platforms are expected to carry a certain ME hardware
generation and specific platforms a certain firmware version range.</p>
<h2 id="processor-names"><a class="header" href="#processor-names">Processor names</a></h2>
<p>Intel publicly documents how to interpret procesor names<sup class="footnote-reference" id="fr-12-1"><a href="#footnote-12">16</a></sup> and what their
suffixes mean<sup class="footnote-reference" id="fr-13-1"><a href="#footnote-13">17</a></sup>.</p>
<h2 id="abbreviations"><a class="header" href="#abbreviations">Abbreviations</a></h2>
<div class="table-wrapper"><table><thead><tr><th>abbr.</th><th>expansion</th></tr></thead><tbody>
<tr><td>ACM</td><td>Authenticated Code Module</td></tr>
<tr><td>AMT</td><td>Active Management Technology</td></tr>
<tr><td>CSME</td><td>Converged Security and Manageability Engine</td></tr>
<tr><td>DAL</td><td>Dynamic Application Loader</td></tr>
<tr><td>FIT</td><td>Firmware Interface Table</td></tr>
<tr><td>FPT</td><td>Firmware Partition Table</td></tr>
<tr><td>HAP</td><td>High-Assurance Platform</td></tr>
<tr><td>{I,M,P}CH</td><td>{I/O,Memory,Platform} Controller Hub<sup class="footnote-reference" id="fr-9-1"><a href="#footnote-9">18</a></sup></td></tr>
<tr><td>IFD</td><td>Intel Flash Descriptor</td></tr>
<tr><td>PTT</td><td>Platform Trust Technology</td></tr>
<tr><td>RBE</td><td>ROM Boot Extensions (part of ME firmware)</td></tr>
<tr><td>SPS</td><td>Server Platform Services</td></tr>
<tr><td>TXE</td><td>Trusted Execution Engine</td></tr>
<tr><td>TXT</td><td>Trusted Execution Technology</td></tr>
</tbody></table>
</div>
<h3 id="ambiguities"><a class="header" href="#ambiguities">Ambiguities</a></h3>
<p>There are colliding acronyms, even within this domain.
The following abbreviations have a second meaning:</p>
<ul>
<li>FIT: <em>Flash Image Tool</em> (sometimes also called <em>FITC</em>)</li>
<li>FPT: <em>Flash Programming Tool</em></li>
</ul>
<hr>
<ol class="footnote-definition"><li id="footnote-14">
<p><a href="https://en.wikipedia.org/wiki/List_of_Intel_processors">https://en.wikipedia.org/wiki/List_of_Intel_processors</a> <a href="#fr-14-1">↩</a></p>
</li>
<li id="footnote-15">
<p><a href="https://en.wikipedia.org/wiki/Intel_AMT_versions">https://en.wikipedia.org/wiki/Intel_AMT_versions</a> <a href="#fr-15-1">↩</a></p>
</li>
<li id="footnote-1">
<p><a href="https://www.amplicon-usa.com/actions/viewDoc.cfm?doc=iAMT-white-paper.pdf">https://www.amplicon-usa.com/actions/viewDoc.cfm?doc=iAMT-white-paper.pdf</a> <a href="#fr-1-1">↩</a></p>
</li>
<li id="footnote-16">
<p><a href="https://www.intel.com/content/www/us/en/architecture-and-technology/vpro/overview.html">https://www.intel.com/content/www/us/en/architecture-and-technology/vpro/overview.html</a> <a href="#fr-16-1">↩</a></p>
</li>
<li id="footnote-2">
<p><a href="https://edc.intel.com/content/www/us/en/design/ipla/software-development-platforms/client/platforms/alder-lake-desktop/12th-generation-intel-core-processors-datasheet-volume-1-of-2/010/boot-guard-technology/">https://edc.intel.com/content/www/us/en/design/ipla/software-development-platforms/client/platforms/alder-lake-desktop/12th-generation-intel-core-processors-datasheet-volume-1-of-2/010/boot-guard-technology/</a> <a href="#fr-2-1">↩</a></p>
</li>
<li id="footnote-20">
<p><a href="https://www.intel.com/content/dam/support/us/en/documents/technologies/intel_amt_linux_enablement_guide_revision_1_1.pdf">https://www.intel.com/content/dam/support/us/en/documents/technologies/intel_amt_linux_enablement_guide_revision_1_1.pdf</a> <a href="#fr-20-1">↩</a></p>
</li>
<li id="footnote-3">
<p><a href="https://i.blackhat.com/USA-19/Wednesday/us-19-Hasarfaty-Behind-The-Scenes-Of-Intel-Security-And-Manageability-Engine.pdf">https://i.blackhat.com/USA-19/Wednesday/us-19-Hasarfaty-Behind-The-Scenes-Of-Intel-Security-And-Manageability-Engine.pdf</a> <a href="#fr-3-1">↩</a></p>
</li>
<li id="footnote-19">
<p><a href="https://www.intel.com/content/dam/www/public/us/en/security-advisory/documents/intel-csme-security-white-paper.pdf">https://www.intel.com/content/dam/www/public/us/en/security-advisory/documents/intel-csme-security-white-paper.pdf</a> <a href="#fr-19-1">↩</a></p>
</li>
<li id="footnote-17">
<p><a href="https://www.intel.com/content/www/us/en/developer/articles/technical/software-security-guidance/resources/key-usage-in-integrated-firmware-images.html">https://www.intel.com/content/www/us/en/developer/articles/technical/software-security-guidance/resources/key-usage-in-integrated-firmware-images.html</a> <a href="#fr-17-1">↩</a></p>
</li>
<li id="footnote-18">
<p><a href="https://bitkeks.eu/blog/2017/12/the-intel-management-engine.html">https://bitkeks.eu/blog/2017/12/the-intel-management-engine.html</a> <a href="#fr-18-1">↩</a></p>
</li>
<li id="footnote-4">
<p><a href="https://papers.put.as/papers/firmware/2014/2014-10_Breakpoint_Intel_ME_-_Two_Years_Later.pdf">https://papers.put.as/papers/firmware/2014/2014-10_Breakpoint_Intel_ME_-_Two_Years_Later.pdf</a> <a href="#fr-4-1">↩</a></p>
</li>
<li id="footnote-6">
<p><a href="https://www.intel.com/content/www/us/en/support/articles/000055675/technologies.html?wapkw=csme">https://www.intel.com/content/www/us/en/support/articles/000055675/technologies.html?wapkw=csme</a> <a href="#fr-6-1">↩</a></p>
</li>
<li id="footnote-8">
<p><a href="https://github.com/flothrone/bootguard">https://github.com/flothrone/bootguard</a> <a href="#fr-8-1">↩</a></p>
</li>
<li id="footnote-10">
<p><a href="https://web.archive.org/web/20201129154607/https://www.intel.com/content/dam/www/public/us/en/documents/product-briefs/4th-gen-core-family-mobile-brief.pdf">https://web.archive.org/web/20201129154607/https://www.intel.com/content/dam/www/public/us/en/documents/product-briefs/4th-gen-core-family-mobile-brief.pdf</a> <a href="#fr-10-1">↩</a></p>
</li>
<li id="footnote-11">
<p><a href="https://web.archive.org/web/20230322090345/https://patrick.georgi.family/2015/02/17/intel-boot-guard/">https://web.archive.org/web/20230322090345/https://patrick.georgi.family/2015/02/17/intel-boot-guard/</a> <a href="#fr-11-1">↩</a></p>
</li>
<li id="footnote-12">
<p><a href="https://www.intel.com/content/www/us/en/processors/processor-numbers.html">https://www.intel.com/content/www/us/en/processors/processor-numbers.html</a> <a href="#fr-12-1">↩</a></p>
</li>
<li id="footnote-13">
<p><a href="https://www.intel.com/content/www/us/en/support/articles/000058567/processors/intel-core-processors.html">https://www.intel.com/content/www/us/en/support/articles/000058567/processors/intel-core-processors.html</a> <a href="#fr-13-1">↩</a></p>
</li>
<li id="footnote-9">
<p><a href="https://en.wikipedia.org/wiki/Intel_Hub_Architecture">https://en.wikipedia.org/wiki/Intel_Hub_Architecture</a> <a href="#fr-9-1">↩</a></p>
</li>
</ol><div style="break-before: page; page-break-before: always;"></div><h1 id="knowledge-on-firmware-images-for-intel-platforms"><a class="header" href="#knowledge-on-firmware-images-for-intel-platforms">Knowledge on Firmware Images for Intel Platforms</a></h1>
<p>The knowledge here focuses on firmware images, their partitioning and data
structures.</p>
<h2 id="official-resources"><a class="header" href="#official-resources">Official resources</a></h2>
<p>Intel publishes general information on firmware in their developer portal:
<a href="https://www.intel.com/content/www/us/en/developer/topic-technology/firmware/overview.html">https://www.intel.com/content/www/us/en/developer/topic-technology/firmware/overview.html</a>
Note that the public information mainly focuses on host processor firmware.</p>
<h2 id="other-projects"><a class="header" href="#other-projects">Other projects</a></h2>
<ul>
<li><a href="https://github.com/corna/me_cleaner/wiki/"><code>me_cleaner</code> wiki</a></li>
<li><a href="https://github.com/platomav/meanalyzer/">ME Analyzer</a></li>
<li>coreboot
<ul>
<li><a href="https://doc.coreboot.org/soc/intel">Intel SoC documentation</a></li>
<li><a href="https://doc.coreboot.org/security/intel/acm.html">Authenticated Code Module</a></li>
<li><a href="https://github.com/coreboot/coreboot/tree/main/util/ifdtool"><code>ifdtool</code></a></li>
<li><a href="https://github.com/coreboot/coreboot/tree/main/util/intelmetool"><code>intelmetool</code></a></li>
</ul>
</li>
<li>UEFITool
<ul>
<li><a href="https://github.com/LongSoft/UEFITool/blob/new_engine/common/descriptor.h">IFD</a></li>
<li><a href="https://github.com/LongSoft/UEFITool/blob/new_engine/common/meparser.cpp">ME parser</a></li>
<li><a href="https://github.com/LongSoft/UEFITool/blob/new_engine/common/fitparser.cpp">FIT parser</a></li>
</ul>
</li>
<li>Positive Technologies research
<ul>
<li><a href="https://github.com/ptresearch/IntelTXE-PoC">TXE MFS exploit PoC</a></li>
<li><a href="https://github.com/ptresearch/me-disablement">ME disablement</a></li>
<li><a href="https://github.com/ptresearch?tab=repositories">many other repositories</a></li>
</ul>
</li>
</ul>
<h2 id="research"><a class="header" href="#research">Research</a></h2>
<p>Many researchers have looked into the Intel Management Engine over the years and
presented on their findings:</p>
<ul>
<li><a href="https://media.ccc.de/v/34c3-8762-inside_intel_management_engine">https://media.ccc.de/v/34c3-8762-inside_intel_management_engine</a></li>
<li><a href="https://media.ccc.de/v/36c3-10694-intel_management_engine_deep_dive">https://media.ccc.de/v/36c3-10694-intel_management_engine_deep_dive</a></li>
</ul>
<h2 id="forums"><a class="header" href="#forums">Forums</a></h2>
<p>People keep <a href="https://community.intel.com/t5/Embedded-Intel-Core-Processors/MFit-Tool-Flash-Image-Tool/m-p/1640753">asking in Intel's community forum</a>
for <a href="https://community.intel.com/t5/Embedded-Intel-Core-Processors/Where-to-Download-Flash-Image-Tool-fitc/td-p/249920">tools and information around Intel platform firmware</a>,
resorting to third-party forums because Intel does not publish what they need or
limits access to necessary resources to certain customers only, notably not end
users.
Here is a short list of places to find useful information and tools.</p>
<ul>
<li>Win-Raid (Level1Techs) Forum
<ul>
<li><a href="https://winraid.level1techs.com/t/intel-cs-management-engine-drivers-firmware-and-tools-2-15/30719">(CS)ME firmware and tools</a></li>
<li><a href="https://winraid.level1techs.com/t/intel-cs-me-cs-txe-cs-sps-gsc-pmc-pchc-phy-orom-firmware-repositories/30869">(CS)ME etc firmware repositories</a></li>
<li><a href="https://winraid.level1techs.com/t/me-analyzer-intel-engine-firmware-analysis-tool-discussion/30876">ME Analyzer</a></li>
<li><a href="https://winraid.level1techs.com/t/parsing-effs-partition/34609">EFFS in ME Gen 2</a></li>
</ul>
</li>
<li><a href="https://www.badcaps.net/forum/troubleshooting-hardware-devices-and-electronics-theory/troubleshooting-desktop-motherboards-graphics-cards-and-pc-peripherals/105308-fit-csme-tool-flash-image-tool-trusted-download-location">Badcaps Forum</a></li>
<li><a href="https://www.indiafix.in/2024/09/download-intel-flash-image-tool-fitc.html?m=1">Indiafix Forum</a></li>
<li><a href="https://vinafix.com/tags/flash-image-tool/">Vinafix Forum</a></li>
<li><a href="https://www.alisaler.com/intel-me-system-tools-v11-6-r8-flash-image-tool-download/">AliSaler</a></li>
<li><a href="https://github.com/mostav02/Remove_IntelME_FPT">mostav02's notes on FPT and removals</a></li>
</ul>
<h3 id="extraction"><a class="header" href="#extraction">Extraction</a></h3>
<p>For older FIT tools, use <code>binwalk</code> to extract resources and then <code>grep</code> for
<code>LayoutEntry</code> to find descriptions of straps, which include the HAP bit, e.g.:</p>
<pre><code>&lt;LayoutEntry name="PCH_Strap_CSME_CSE_HAP_Mode" type="bitfield32"
    value="0x0" offset="0x68" bitfield_high="16" bitfield_low="16" /&gt;
</code></pre>
<p>Note that later generation XML files just call the HAP bit "reserved".
Educated guessing by looking at neighboring bits will help you to locate it.</p>
<p>Newer FIT tools (e.g., v18) contain Python code that can be extracted with
<a href="https://github.com/extremecoders-re/pyinstxtractor">pyinstxtractor</a>. Relevant
code is in the <code>plugins/</code> directory:</p>
<pre><code class="language-sh">pyinstxtractor.py ../mfit_18.exe
ls -l tools.exe_extracted/plugins/
</code></pre>

                    </main>

                    <nav class="nav-wrapper" aria-label="Page navigation">
                        <!-- Mobile navigation buttons -->


                        <div style="clear: both"></div>
                    </nav>
                </div>
            </div>

            <nav class="nav-wide-wrapper" aria-label="Page navigation">

            </nav>

        </div>




        <script>
            window.playground_copyable = true;
        </script>


        <script src="elasticlunr.min.js"></script>
        <script src="mark.min.js"></script>
        <script src="searcher.js"></script>

        <script src="clipboard.min.js"></script>
        <script src="highlight.js"></script>
        <script src="book.js"></script>

        <!-- Custom JS scripts -->

        <script>
        window.addEventListener('load', function() {
            window.setTimeout(window.print, 100);
        });
        </script>

    </div>
    </body>
</html>
